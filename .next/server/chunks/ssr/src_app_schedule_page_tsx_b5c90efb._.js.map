{"version":3,"sources":["../../../../src/app/schedule/page.tsx","../../../../src/components/auth/phone-login.tsx"],"sourcesContent":["\"use client\";\n\nimport { useConvexAuth } from \"convex/react\";\nimport { PhoneLogin } from \"@/components/auth/phone-login\";\n\nexport default function SchedulePage() {\n  const { isAuthenticated, isLoading } = useConvexAuth();\n\n  if (isLoading) {\n    return (\n      <main className=\"flex min-h-screen items-center justify-center\">\n        <div className=\"animate-pulse text-2xl text-gray-500\">טוען...</div>\n      </main>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return (\n      <main className=\"flex min-h-screen flex-col items-center justify-center gap-6 p-4\">\n        <div className=\"text-center\">\n          <h1 className=\"text-3xl font-bold\">לב שרה</h1>\n          <p className=\"text-gray-600 mt-2\">תורנות ביקורים אצל אבא</p>\n        </div>\n        <PhoneLogin />\n      </main>\n    );\n  }\n\n  return (\n    <main className=\"min-h-screen p-4\">\n      <header className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold\">לוח ביקורים</h1>\n      </header>\n      {/* WeekView component will be added in Phase 2 */}\n      <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-8 text-center text-gray-500\">\n        לוח הביקורים יופיע כאן\n      </div>\n    </main>\n  );\n}\n","\"use client\";\n\nimport { useAuthActions } from \"@convex-dev/auth/react\";\nimport { useState } from \"react\";\n\ntype Step = \"phone\" | \"otp\";\n\nexport function PhoneLogin() {\n  const { signIn } = useAuthActions();\n  const [step, setStep] = useState<Step>(\"phone\");\n  const [phone, setPhone] = useState(\"\");\n  const [otp, setOtp] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  // Format phone for display (Israeli format)\n  const formatPhoneDisplay = (value: string) => {\n    const digits = value.replace(/\\D/g, \"\");\n    if (digits.length <= 3) return digits;\n    if (digits.length <= 6) return `${digits.slice(0, 3)}-${digits.slice(3)}`;\n    return `${digits.slice(0, 3)}-${digits.slice(3, 6)}-${digits.slice(6, 10)}`;\n  };\n\n  // Convert to international format\n  const toInternational = (phoneNumber: string) => {\n    const digits = phoneNumber.replace(/\\D/g, \"\");\n    // If starts with 0, replace with +972\n    if (digits.startsWith(\"0\")) {\n      return `+972${digits.slice(1)}`;\n    }\n    // If already has country code\n    if (digits.startsWith(\"972\")) {\n      return `+${digits}`;\n    }\n    // Assume Israeli number\n    return `+972${digits}`;\n  };\n\n  const handlePhoneSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    setLoading(true);\n\n    try {\n      const internationalPhone = toInternational(phone);\n      await signIn(\"whatsapp-phone\", { phone: internationalPhone });\n      setStep(\"otp\");\n    } catch (err) {\n      setError(\"שגיאה בשליחת הקוד. נסה שוב.\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleOtpSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    setLoading(true);\n\n    try {\n      const internationalPhone = toInternational(phone);\n      await signIn(\"whatsapp-phone\", { phone: internationalPhone, code: otp });\n    } catch (err) {\n      setError(\"קוד שגוי. נסה שוב.\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (step === \"phone\") {\n    return (\n      <form onSubmit={handlePhoneSubmit} className=\"w-full max-w-xs space-y-4\">\n        <div>\n          <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n            מספר טלפון\n          </label>\n          <input\n            id=\"phone\"\n            type=\"tel\"\n            value={formatPhoneDisplay(phone)}\n            onChange={(e) => setPhone(e.target.value.replace(/\\D/g, \"\"))}\n            placeholder=\"050-123-4567\"\n            className=\"w-full px-4 py-3 text-lg border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center\"\n            dir=\"ltr\"\n            autoComplete=\"tel\"\n            required\n          />\n        </div>\n\n        {error && (\n          <p className=\"text-red-600 text-sm text-center\">{error}</p>\n        )}\n\n        <button\n          type=\"submit\"\n          disabled={loading || phone.length < 9}\n          className=\"w-full py-3 px-4 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors\"\n        >\n          {loading ? \"שולח...\" : \"שלח קוד בוואטסאפ\"}\n        </button>\n      </form>\n    );\n  }\n\n  return (\n    <form onSubmit={handleOtpSubmit} className=\"w-full max-w-xs space-y-4\">\n      <div>\n        <label htmlFor=\"otp\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n          קוד אימות\n        </label>\n        <p className=\"text-xs text-gray-500 mb-2\">\n          נשלח קוד לוואטסאפ שלך ({formatPhoneDisplay(phone)})\n        </p>\n        <input\n          id=\"otp\"\n          type=\"text\"\n          inputMode=\"numeric\"\n          value={otp}\n          onChange={(e) => setOtp(e.target.value.replace(/\\D/g, \"\").slice(0, 6))}\n          placeholder=\"000000\"\n          className=\"w-full px-4 py-3 text-2xl tracking-[0.5em] border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center font-mono\"\n          dir=\"ltr\"\n          autoComplete=\"one-time-code\"\n          required\n        />\n      </div>\n\n      {error && (\n        <p className=\"text-red-600 text-sm text-center\">{error}</p>\n      )}\n\n      <button\n        type=\"submit\"\n        disabled={loading || otp.length !== 6}\n        className=\"w-full py-3 px-4 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors\"\n      >\n        {loading ? \"מאמת...\" : \"כניסה\"}\n      </button>\n\n      <button\n        type=\"button\"\n        onClick={() => {\n          setStep(\"phone\");\n          setOtp(\"\");\n          setError(\"\");\n        }}\n        className=\"w-full py-2 text-sm text-gray-600 hover:text-gray-800\"\n      >\n        שלח קוד חדש\n      </button>\n    </form>\n  );\n}\n"],"names":[],"mappings":"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"}